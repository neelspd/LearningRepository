######################################################################################################
# This program is for calculating the frequency of the words in the string retrived from a data base #
# psycopg2 is actually a library or a DB driver for postgres and python ##############################
# Author : Neel Shah #################################################################################
# Date Stamp: 22052019 ###############################################################################
######################################################################################################

import psycopg2
######################################################################################################
# Establising connection #############################################################################
######################################################################################################

connection = psycopg2.connect(database = "postgres", user = "postgres",
                                  password = "04AprilSU",
                                  host = "141.13.162.158",
                                  port = "5432")

print("Opened database successfully")

#####################################################################################################
# Sttring up cursor for Data retrival from DB to Main Memory ########################################
#####################################################################################################

cursor = connection.cursor()

#####################################################################################################
# Query Execution ###################################################################################
#####################################################################################################

cursor.execute("select message_body from email.emails")
rows = cursor.fetchall()

#####################################################################################################
# Closing DB Connection #############################################################################
#####################################################################################################

cursor.close()
connection.close()

########################################################################################################
# Starting Process #####################################################################################
# Here what happens is that the dictonary is traversed which contais the results from the DB, ##########
# And the string of e-mails is than split into a  word list which is than used for the frequency count #  

for row in rows:
   print(row[0] + "\n")
   WordList = str(row[0]).split()
   word_length = len(WordList);
   print("Length: " +  str(word_length) + " \n")
   for word in WordList:
       frequency = str(row[0]).count(word)
       print( word + " : " + str(frequency))
       print("\n")
   print("\n\n")

print("Operation done successfully")

# End Program #######################################################################################
#####################################################################################################
